<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Test Chat</title>
  <script src="/socket.io/socket.io.js"></script>
</head>
<body>
  <h1>Customer Support Chat</h1>

  <label>Chat ID: <input id="chatId" value="chat123" /></label>
  <label>Sender: <input id="sender" value="Customer1" /></label>
  <button onclick="joinChat()">Join Chat</button>

  <h2>Messages:</h2>
  <div id="messages"></div>

  <input id="msg" placeholder="Type message..." onkeyup="typing()" />
  <button onclick="sendMessage()">Send</button>

  <script>
    const socket = io("http://localhost:3001");

    function joinChat() {
      const chatId = document.getElementById("chatId").value;
      socket.emit("joinChat", chatId);

      socket.on("newMessage", (msg) => {
        const div = document.createElement("div");
        div.textContent = msg.sender + ": " + msg.message;
        document.getElementById("messages").appendChild(div);
      });

      socket.on("typing", ({ sender }) => {
        console.log(sender + " is typing...");
      });
    }

    function sendMessage() {
      const chatId = document.getElementById("chatId").value;
      const sender = document.getElementById("sender").value;
      const message = document.getElementById("msg").value;
      socket.emit("sendMessage", { chatId, sender, message });
      document.getElementById("msg").value = "";
    }

    function typing() {
      const chatId = document.getElementById("chatId").value;
      const sender = document.getElementById("sender").value;
      socket.emit("typing", { chatId, sender });
    }
  </script>
</body>
</html>
